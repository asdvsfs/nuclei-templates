id: discord-invite-detect

info:
  name: Discord Invites for Users, Bots & Servers - Detect
  author: rxerium
  severity: info
  description: |
    Detect Discord Invites for users, bots and servers
  reference:
    - https://discord.com
  tags: discord,info,osint,misc

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    extractors:
      - type: regex
        name: discord-server-invite
        regex:
          - "https?:\\/\\/(?:www\\.)?discord\\.gg\\/([a-zA-Z0-9-]+)"

      - type: regex
        name: discord-user-invite
        regex:
          - "https?:\\/\\/discord\\.com\\/users\\/([0-9]+)"

      - type: regex
        name: discord-bot-invite
        regex:
          - "https?:\\/\\/discord\\.com\\/oauth2\\/authorize\\?client_id=([0-9]+)[^\\s\"']*"
# digest: 4a0a0047304502206d13ffab77a25713364086ed1db2848d079fb9846735312190b8d21c7b6ac8f8022100dad89e4d0b6f5be130d4ca5da4bd1243f2d7135ceee6b2a2a49de4a695f43a9b:922c64590222798bb761d5b6d8e72950